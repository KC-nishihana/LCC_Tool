# Blender用 LCCツール

LCCツールは、LCC（Lightweight Compressed Cloud）スプラットデータをインポートしてレンダリングするために設計されたBlenderアドオンです。`.lcc`ファイルを読み込み、ジオメトリノードを使用して可視化し、Cyclesエンジンを使用して高品質な360度パノラマレンダリングをセットアップすることができます。

## 機能

*   **LCCインポート**: `.lcc`ファイルとそれに関連する `Index.bin` および `Data.bin` データを読み込みます。
*   **LOD（詳細度）サポート**: 品質とパフォーマンスのバランスを取るために、詳細度（LOD）を選択可能です。
*   **ジオメトリノードレンダリング**: スプラットを3D楕円体としてレンダリングするためのジオメトリノードモディファイアを自動的にセットアップします。
*   **カスタムシェーダー**: 正確なスプラット表現のために、ガウス減衰（Gaussian falloff）を持つ `GaussianSplatMat` マテリアルを生成します。
*   **360度レンダリングセットアップ**: パノラマカメラを自動的に構成し、透過処理や大量のパーティクル向けにCyclesの設定を最適化するオプションがあります。
*   **使いやすいパネル**: 3Dビューのサイドバーにある「LCC Tools」タブからアクセスできます。

## 必須要件

*   **Blender**: バージョン 3.3 以上（ジオメトリノードの互換性のため推奨）。
*   **Python ライブラリ**: `numpy`（Blenderに標準搭載されています）。

## インストール方法

1.  `LCC_Render.py` をダウンロードします。
2.  Blenderを開きます。
3.  **編集 (Edit) > プリファレンス (Preferences) > アドオン (Add-ons)** に移動します。
4.  **インストール... (Install...)** をクリックし、`LCC_Render.py` を選択します。
5.  **Import-Export: LCC Tools** のチェックボックスをオンにして、アドオンを有効にします。
    *   *または、Scriptingワークスペースでスクリプトを開き、直接実行することも可能です。*

## 使用方法

1.  3Dビューポートで `N` キーを押してサイドバーを開きます。
2.  **LCC Tools** タブをクリックします。
3.  **Import LCC (.lcc)** ボタンをクリックします。
4.  対象の `.lcc` ファイルを探して選択します。
5.  ファイルブラウザのサイドバー（左下）またはポップアップでインポート設定を調整します：
    *   **LOD Level**: 詳細レベルを選択します（0が最高品質ですが、最も重くなります）。
    *   **Splat Scale Multiplier**: 隙間を埋めるためにスプラットのサイズを調整します（デフォルト: 1.5）。
    *   **Min Thickness**: 最小の厚みを設定し、角度によってスプラットが消えて見えるのを防ぎます。
    *   **Setup 360 Render**: これにチェックを入れると、自動的にパノラマカメラを作成し、レンダリング設定を最適化します。
6.  **Import LCC** をクリックして完了します。

## インポート設定の詳細

*   **LOD Level**: インポートされる点群の密度を制御します。
    *   `0`: フル解像度（重い）。
    *   `1-5`: ビューポートのパフォーマンス向上のための低解像度版。
*   **Splat Scale Multiplier**: 全てのスプラットのスケールを乗算します。値を大きくすると表面が埋まって見えますが、「塊」のように見える場合があります。
*   **Min Thickness**: スプラット楕円体の最小軸に対して最小スケールを強制します。平らなスプラットを横から見た際にアーティファクトが発生するのを防ぐのに役立ちます。
*   **Setup 360 Render**:
    *   レンダリングエンジンを **Cycles** に切り替えます。
    *   (0,0,0) の位置に **PanoramaCam** を作成します。
    *   解像度を 4096x2048 に設定します。
    *   多数の重なり合う半透明スプラットを処理するために、透過バウンス数（Transparency bounces）を増やします。

## 技術的詳細

インポーターは、スプラットデータ（位置、色、スケール、回転）が `Index.bin` と `Data.bin` に分散されたカスタムバイナリ形式を読み込みます。
*   **回転**は、パックされた uint32 形式からクォータニオンにデコードされ、その後オイラー角に変換されます。
*   **レンダリング**は、ジオメトリノードを使用してポイント上にIco Sphere（アイコスフィア）をインスタンス化することで処理されます。見た目は、各インスタンスの中心からのガウスアルファ減衰を計算するシェーダーによって制御されます。
